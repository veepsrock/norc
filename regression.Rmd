---
title: "Regression Analysis for FS and NS"
author: "Tazz Orchi"
date: "2024-01-24"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 

setwd("/Users/torchi/Documents/GitHub/norc")

source("001_data_processing.R")
source("002_recode.R")

library(ggplot2)
library(glmnet)
library(stargazer)
library(jtools)
```

## Comparing Income

We use Income as a Reference category (people making between 60K-100K) and want to compare the odds ratio of the other categories

```{r income reference}
glm <- glm(low_fs ~ relevel(factor(income4), ref = 3), data = df, family = "binomial")
#stargazer(glm, type = "text", title = "Income Reference")
summ(glm, confint = TRUE, digits = 3, exp = TRUE)
```
## Regression Analysis 

### Q8A

#### Healthy foods are too expensive (often/sometimes true, never true, etc.)

```{r logit1, results='asis'}
logit_model1 <- glm(low_fs ~ q8a + age + income4, data = df, family = "binomial")
#stargazer(logit_model1, type = "text", title = "Logistic Regression Summary")

#ggplot(df2, aes(x = age, y = low_fs)) +
  #geom_point() +
  #stat_smooth(method = "glm", family = "binomial", se = FALSE, color = "blue") +
  #labs(title = "Logistic Regression", x = "Independent Variable", y = "Binary Dependent Variable")

summ(logit_model1, confint = TRUE, digits = 3, exp = TRUE)
```

#### Conclusion:  

### Q8B 

#### Question content

```{r logit2, results='asis'}
logit_model2 <- glm(low_fs ~ q8b + age + income, data = df, family = "binomial")
#stargazer(logit_model2, type = "text", title = "Logistic Regression Summary")

summ(logit_model2, confint = TRUE, digits = 3, exp = TRUE)
```

#### Conclusion: 

### Q8C

#### Question content

```{r logit3, results='asis'}
logit_model3 <- glm(low_fs ~ q8c + age + income, data = df, family = "binomial")
#stargazer(logit_model3, type = "text", title = "Logistic Regression Summary")

summ(logit_model3, confint = TRUE, digits = 3, exp = TRUE)
```
#### Conclusion:

### Q8d

#### Question content

```{r logit3, results='asis'}
logit_model4 <- glm(low_fs ~ q8d + age + income, data = df, family = "binomial")
#stargazer(logit_model3, type = "text", title = "Logistic Regression Summary")

summ(logit_model4, confint = TRUE, digits = 3, exp = TRUE)
```
#### Conclusion 

### Q8e

#### Question content

```{r logit3, results='asis'}
logit_model5 <- glm(low_fs ~ q8e + age + income, data = df, family = "binomial")
#stargazer(logit_model3, type = "text", title = "Logistic Regression Summary")

summ(logit_model5, confint = TRUE, digits = 3, exp = TRUE)
```
#### Conclusion 

### Q8f

#### Question content

```{r logit3, results='asis'}
logit_model6 <- glm(low_fs ~ q8f + age + income, data = df, family = "binomial")
#stargazer(logit_model3, type = "text", title = "Logistic Regression Summary")

summ(logit_model6, confint = TRUE, digits = 3, exp = TRUE)
```
#### Conclusion

### Q8g

#### Question content

```{r logit3, results='asis'}
logit_model7 <- glm(low_fs ~ q8g + age + income, data = df, family = "binomial")
#stargazer(logit_model3, type = "text", title = "Logistic Regression Summary")

summ(logit_model7, confint = TRUE, digits = 3, exp = TRUE)
```

#### Conclusion:

### Q8h

#### Question content

```{r logit3, results='asis'}
logit_model8 <- glm(low_fs ~ q8h + age + income, data = df, family = "binomial")
#stargazer(logit_model3, type = "text", title = "Logistic Regression Summary")

summ(logit_model8, confint = TRUE, digits = 3, exp = TRUE)
```

#### Conclusion: 

### Q8i

#### Question Content

```{r logit3, results='asis'}
logit_model9 <- glm(low_fs ~ q8i + age + income, data = df, family = "binomial")
#stargazer(logit_model3, type = "text", title = "Logistic Regression Summary")

summ(logit_model9, confint = TRUE, digits = 3, exp = TRUE)
```

#### Conclusion